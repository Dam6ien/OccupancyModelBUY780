An agent based model is created in AnyLogic to simulate the arrival of occupants and their interactions with spaces and lighting equipment. In the following section, core features of the AnyLogic model are described followed by a description of the experimental set up.

The office space understudy is abstracted into system consisting of occupant agents, space agents and a building agent to model the lighting and base load of the office space. 

Occupant agents consists of a state-chart that transitions between at home and at work. The transition is triggered by two conditions; a random variable governing the arrival and departure of each occupant, and if the model day is a working day. On arrival, the occupant randomly selects a space with sufficient capacity to occupy for the day and sets it's departure time. An occupant is bounded to the selected space for the rest of the day and does not leave the space. Occupants are assumed to arrive every working day, implying that leave and public holidays are not incorporated into the model. On departure the occupant is removed from the space and the arrival time for the following day is set. 

 Space agents consist of an occupancy state-chart and a lighting state-chart. The occupancy state-chart transitions from empty to occupied when an occupant enters a space and from occupied to empty when an occupant departs. Whilst in the occupied status, the lighting state-chart is triggered to transition to the on status and sets the lighting load as a function of the space area. This is evaluated by multiplying the total lighting load by the proportionate area it uses in the building. When the occupancy state-chart transitions to unoccupied, the lighting state-chart remains in the on status for 15 minutes before transitioning to the off status, simulating the delayed response time of lighting sensors. The number of spaces is fixed at eight, representing the available spaces in the office. Common areas (canteen, passage, unused office) are controlled by the same occupancy sensor as the open planned space as these areas would be accessed by the same occupants.
 
 The building agent is a composite agent consisting of occupants and spaces. The behaviour and interactions of each occupant and each space aggregate to the total lighting load of the building. In addition, the building facilitates model visualisations, aggregation of energy data and allows the user to toggle between the base case and occupancy sensor case.

Base case
All lights are controlled by a single switch in the office under study. The lights are turned on by the first occupant to enter the building at the start of the day and turned off by the last occupant to exit the building at the end of the day. To simulate this behaviour an additional condition is created within the space agent's lighting state-chart. The condition evaluates if either an occupant is in the current space or if an occupant is in any space. If the latter is true, the lighting state-chart transitions to the on status for all space agents in the population. A radio button, visible in the building agent, allows the user to toggle between the base case and the occupancy sensor case. The availability of spaces in the base case, namely meetings rooms, has minimal affect on the lighting load, thus the base base is evaluated without consideration of meeting room capacity. The base case is simulated for a year (366 days) in AnyLogic with 5, 10 and 15 occupants each year. The number of occupants do not exceed the total capacity of the office space. The results are written to a text file and analysed in R.

Occupancy sensor case
The occupancy sensor case disaggregates the singular lighting control system into multiple, independent control systems. As such, considerations around the use of spaces that are infrequently or temporarily used, such as meeting rooms will have a significant impact. An unavailable space will not consume energy and directly influences the load. As the occupant assignment to a space is random, meeting rooms could experience more occupants than actually occur. A radio button allows the user to select one of three meeting room configurations; unavailable, 50% capacity or 100% capacity. This functionality provides the ability to asses the impact of COVID-19 legislation, which may prohibit meetings in spaces of certain size. Each of these states is modelled as occupancy case 1, occupancy case 2 and occupancy case 3 respectively. Each occupancy sensor case is simulated for a year (366 days) with 5, 10 and 15 occupants resulting in a total of nine experiments. The simulation is conducted in AnyLogic which writes results to a text file and further analysed in R.

The model can be run at https://cloud.anylogic.com/model/f593fe81-a751-426f-a9b9-8f8d2ab8c993?mode=SETTINGS
